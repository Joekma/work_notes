
watch 命令

watch可以帮你监测一个命令的运行结果，省得你一遍遍的手动运行。
在Linux下，watch是周期性的执行下个程序，并全屏显示执行结果。
你可以拿他来监测你想要的一切命令的结果变化，比如 tail 一个 log 文件，ls 监测某个文件的大小变化，看你的想象力了

-n或--interval  watch缺省每2秒运行一下程序，可以用-n或-interval来指定间隔的时间。

-d或--differences  用-d或--differences 选项watch 会高亮显示变化的区域。 而-d=cumulative选项会把变动过的地方(不管最近的那次有没有变动)都高亮显示出来

-t 或-no-title  会关闭watch命令在顶部的时间间隔,命令，当前时间的输出


实例1 每隔一秒高亮显示网络链接数的变化情况
watch -n 1 -d netstat -ant

切换终端： Ctrl+x
退出watch：Ctrl+g

实例2：每隔一秒高亮显示http链接数的变化情况
watch -n 1 -d 'pstree|grep http'

实例3：实时查看模拟攻击客户机建立起来的连接数
watch 'netstat -an | grep:21 | \ grep<模拟攻击客户机的IP>| wc -l'

实例4：监测当前目录中 scf' 的文件的变化
watch -d 'ls -l|grep scf'

实例5：10秒一次输出系统的平均负载
watch -n 10 'cat /proc/loadavg'



lsof 命令

lsof（list open files）是一个列出当前系统打开文件的工具。在linux环境下，任何事物都以文件的形式存在，通过文件不仅仅可以访问常规数据，还可以访问网络连接和硬件。
所以如传输控制协议 (TCP) 和用户数据报协议 (UDP) 套接字等，系统在后台都为该应用程序分配了一个文件描述符，无论这个文件的本质如何，
该文件描述符为应用程序与基础操作系统之间的交互提供了通用接口。因为应用程序打开文件的描述符列表提供了大量关于这个应用程序本身的信息，因此通过lsof工具能够查看这个列表对系统监测以及排错将是很有帮助的


命令功能：

用于查看你进程开打的文件，打开文件的进程，进程打开的端口(TCP、UDP)。找回/恢复删除的文件。是十分方便的系统监视工具，因为 lsof 需要访问核心内存和各种文件，所以需要root用户执行。

lsof打开的文件可以是：
1.普通文件
2.目录
3.网络文件系统的文件
4.字符或设备文件
5.(函数)共享库
6.管道，命名管道
7.符号链接
8.网络文件（例如：NFS file、网络socket，unix域名socket）
9.还有其它类型的文件，等等


实例2：查看谁正在使用某个文件，也就是说查找某个文件相关的进程
lsof /bin/bash

实例3：递归查看某个目录的文件信息   使用了+D，对应目录下的所有子目录和文件都会被列出
lsof test/test3

实例4：不使用+D选项，遍历查看某个目录的所有文件信息的方法
lsof |grep 'test/test3'


实例5：列出某个用户打开的文件信息
命令：lsof -u username


实例6：列出某个程序进程所打开的文件信息
命令：lsof -c mysql
说明： -c 选项将会列出所有以mysql这个进程开头的程序的文件，其实你也可以写成 lsof | grep mysql, 但是第一种方法明显比第二种方法要少打几个字符了

实例7：列出多个进程多个打开的文件信息

命令：lsof -c mysql -c apache


实例10：通过某个进程号显示该进行打开的文件

命令：lsof -p 1

实例11：列出多个进程号对应的文件信息

命令：lsof -p 1,2,3

实例12：列出除了某个进程号，其他进程号所打开的文件信息

命令：lsof -p ^1

实例13：列出所有的网络连接

命令：lsof -i

实例14：列出所有tcp 网络连接信息

命令：lsof -i tcp

实例15：列出所有udp网络连接信息

命令：lsof -i udp

实例16：列出谁在使用某个端口

命令：lsof -i :3306

实例17：列出谁在使用某个特定的udp端口

命令：lsof -i udp:55

或者：特定的tcp端口

命令：lsof -i tcp:80

实例18：列出某个用户的所有活跃的网络端口

命令：lsof -a -u test -i

实例19：列出所有网络文件系统

命令：lsof -N

实例20：域名socket文件

命令：lsof -u

实例25：列出被进程号为1234的进程所打开的所有IPV4 network files

命令：lsof -i 4 -a -p 1234

实例26：列出目前连接主机peida.linux上端口为：20，21，22，25，53，80相关的所有文件信息，且每隔3秒不断的执行lsof指令

命令：lsof -i @peida.linux:20,21,22,25,53,80  -r  3


ifconfig 命令




